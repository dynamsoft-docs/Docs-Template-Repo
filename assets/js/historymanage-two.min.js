function UrlReplace(){var e=document.URL,t=getUrlVars(e).ver,n=getUrlVars(e).matchVer,i="/v17.2.1/";if(null!=t&&"latest"!=t){var l=findNearestVersion(t);if("latest"!=l&&l!=t){var a=e.replace(t,l);a.indexOf("/docs/")>0&&(a=a.replace("/docs/","/docs-archive"+i),window.location.replace(a))}}null==n&&null!=t&&"latest"!=t&&e.indexOf("/docs/")>0&&(e=e.replace("/docs/","/docs-archive"+i),window.location.replace(e))}function allHerfClick(e,t){return addParam(e),!1}function GetVersionDiff(e,t){if("latest"==t)return 100;if(t<e)return-1;for(var n=e.split("."),i=t.split("."),l=0,a=Math.max(n.length,i.length),r=1,o=0;o<a;o++){var s=o<n.length?n[o]:0;if(isNaN(s)){l+=r;break}var d=o<i.length?i[o]:0;if(isNaN(d)){l+=r;break}var c=d-s;c>=0?(r/=10,l+=r*c):(l-=r,r/=10,l+=r*(c+10))}return l}function addParam(e,t=null,n=!1){if($(e).hasClass("fullUrl"))return void(window.location.href=e.href);var i=e.href,l=i;if(""==i)return;let a=i.indexOf("#"),r=i.indexOf("?"),o="";if(-1!=a)if(1!=r&&a<r){var s=i.split("?"),d=s[0].split("#");o="#"+d[1]}else{var c=i.split("#");o=2==c.length?"#"+c[1]:""}if("sidebar"==t){var f=document.URL.split("/docs/")[0]+"/docs/";if(e.href.indexOf(f)<0)return void(window.location.href=e.href);$(e).hasClass("activeLink")||RequestNewPage(e,l)}else if("docContainer"==t)"_blank"==e.target?window.open(l):findCurLinkOnFullTree(e,l);else if("rightMenuContainer"==t)if(o&&$(o.toLowerCase()).length>0){window.scrollTo(0,$(o.toLowerCase()).offset().top-160);var h=window.location.hash,u=document.URL;h?u=u.replace(h,o):u+="#"+o,$(e).hasClass("active")||history.pushState(null,null,u)}else window.location.href=i+o;else"_blank"==e.target?window.open(l):window.location.href=l}function RequestNewPage(e,t,n=!1){$("#articleContent").addClass("hidden"),$("#loadingContent").show(),fetch(e.href).then(function(e){return e.text()}).then(function(i){document.title=$(i)[1].innerText,!n&&history.pushState(null,null,t);for(var l=0;l<$("#fullTreeMenuListContainer .activeLink").parents("li").length;l++){var a=$("#fullTreeMenuListContainer .activeLink").parents("li")[l];$(a).hasClass("hasActiveLinkList")&&$(a).removeClass("hasActiveLinkList")}$("#fullTreeMenuListContainer .activeLink").removeClass("activeLink"),$(e).addClass("activeLink"),$(e).parents("li.collapseListStyle").length>0&&($(e).parents("li.collapseListStyle").addClass("expandListStyle").removeClass("collapseListStyle"),$(e).parents("li.expandListStyle").find(" > ul").slideDown()),$(e).parents("li.expandListStyle").addClass("hasActiveLinkList");var r=$("#articleContent").hasClass("showRightSideMenu");$("#articleContent").html($(i).find("#articleContent").html()).removeClass("hidden"),r||$("#articleContent").find(".rightSideMenu, .markdown-body").removeClass("showRightSideMenu"),$("#loadingContent").hide(),needh3=1==$(i).find("#articleContent").data("needh3");var o=$(i).find("#dwtRedirectList").html();$("#dwtRedirectList").html(o);var s=document.getElementsByClassName("mainPage")[0];if(s.scrollHeight>s.clientHeight){var d=$(".activeLink").offset().top-$(".mainPage").offset().top;d-s.scrollTop+40>s.clientHeight&&(s.scrollTop=d-200)}if($(".headCounter").hasClass("noTitleIndex")?$("#AutoGenerateSidebar").addClass("noTitleIndex"):$("#AutoGenerateSidebar").removeClass("noTitleIndex"),$(i).find("#docHead").find(".iconsBox a").length>0){var c=$(i).find("#docHead").find(".iconsBox a")[0].href;$("#docHead .iconsBox a").attr("href",c)}var f=$("#articleContent").find("a");for(l=0;l<f.length;l++)f[l].onclick=function(){return addParam(this,"docContainer"),!1};$("#AutoGenerateSidebar").length>0&&($("#fullTreeMenuListContainer").removeClass("needh3"),needh3&&$("#fullTreeMenuListContainer").addClass("needh3"),GenerateContentByHead(needh3),0==$("#AutoGenerateSidebar > ul > li").length?$(".rightSideMenu > p").hide():$(".rightSideMenu > p").show()),$("#crumbs > ul").html($("#crumbs > ul > li").eq(0)),initCrumbs();var h=$(".markdown-body .highlight pre");for(l=0;l<h.length;l++){var u=document.createElement("i");u.className="copyIcon fa fa-copy",h[l].appendChild(u)}let p=$(".multi-panel-switching-prefix");for(let e=0;e<p.length;e++){let t=$(p[e]).find("+ul > li"),n=0;if(g&&""!=g)for(let e=0;e<t.length;e++)"#"+$(t[e]).find("a").attr("href")==g&&(n=e);$(t[n]).addClass("on");let i=$(p[e]).find("+ul ~");showSelectMultiPanel(i,n,needh3)}if($(".multi-panel-switching-prefix + ul > li").on("click",function(){$(this).parent("ul").find("li").removeClass("on"),$(this).addClass("on");let e=$(this).parent("ul").find("~");showSelectMultiPanel(e,$(this).index(),needh3)}),$(".markdown-body .sample-code-prefix").length>0&&getUrlVars(document.URL).lang){var v=getUrlVars(document.URL).lang.toLowerCase().trim().split(",");v&&(1==v.length?sampleCodeSingleLangInit(v[0]):sampleCodeLangsInit(v))}else if($(".markdown-body .sample-code-prefix").length>0){$(".markdown-body .sample-code-prefix + blockquote > ul > li:first-child").addClass("on"),$(".markdown-body .sample-code-prefix + blockquote > ol > li:first-child").addClass("on");var w=$(".markdown-body .sample-code-prefix.template2 + blockquote");for(l=0;l<w.length;l++)$(w[l]).find(">div").eq(0).addClass("on")}anchors.add();var g=t.split("#").length>1?t.split("#")[1].toLowerCase():null,m=$(window).scrollTop();if(g&&$("#"+g).length>0){var C=$("#"+g).offset().top;setTimeout(function(){window.scrollTo(0,C-160),realFunc()},100)}else if(m>0){C=m>$("#overall-header").height()?$("#overall-header").height():m;setTimeout(function(){window.scrollTo(0,C),realFunc()},100)}})}function findCurLinkOnFullTree(e,t,n=!1,i=!1){var l=$("#fullTreeMenuListContainer").find("a"),a=e.href.toLowerCase(),r=document.URL.toLowerCase();if(a=a.indexOf("?")>0?a.split("?")[0]:a.indexOf("#")>0?a.split("#")[0]:a,r=r.indexOf("?")>0?r.split("?")[0]:r.indexOf("#")>0?r.split("#")[0]:r,r==a&&(e.href.split("#").length>1||document.URL.split("#").length>1)&&!i){var o=e.href.split("#").length>1?e.href.split("#")[1].toLowerCase():null,s=$(e).parents("ul");(s.length<=0||!$(s[0]).prev().hasClass("multi-panel-switching-prefix"))&&o&&$("#"+o.toLowerCase()).length>0&&window.scrollTo(0,$("#"+o.toLowerCase()).offset().top-160),!n&&history.pushState(null,null,t)}else{for(var d=!1,c=0;c<l.length;c++){var f=l[c].href;f=f.indexOf("index.html")>0?f.replace("index.html",""):f,a=a.indexOf("index.html")>0?a.replace("index.html",""):a,f=f.indexOf("?")>0?f.split("?")[0]:f.indexOf("#")>0?f.split("#")[0]:f,f&&f.toLowerCase()==a.toLowerCase()&&(d=!0,RequestNewPage(l[c],t,n))}d||(window.location.href=t)}}function changeVersion(e){var t=e.innerText.toLowerCase(),n=null;n=t.indexOf("latest version")>=0?"latest":t.replace("version ","");var i=document.URL,l="/v"+n+"/";if(i.indexOf("web-twain/docs-archive/v18.5.1/")>0&&GetVersionDiff("17.2.1",n)<0&&(l="/v17.2.1/"),GetVersionDiff("18.4",n)<=0&&$("#dwtRedirectList .dwtReditectLink").length>0){var a=$("#dwtRedirectList .dwtReditectLink").val();i=a}var r=getUrlVars(i).src,o=void 0;return-1!=i.indexOf("#")&&(o=i.split("#").pop()),-1!=i.indexOf("?")&&(i=i.substring(0,i.indexOf("?"))),-1!=i.indexOf("#")&&(i=i.substring(0,i.indexOf("#"))),i=i+"?ver="+n+"&&cVer=true",null!=r&&(i=i+"&&src="+r),null!=o&&(i=i+"#"+o),i.indexOf("web-twain/docs-archive/v18.5.1/")>0&&"latest"==n?(i=i.replace("/docs-archive/v18.5.1/","/docs/"),void(window.location.href=i)):(i=i.replace("/docs-archive/v18.5.1/","/docs-archive"+l),void checkLinkIsValid(i,l))}async function checkLinkIsValid(e,t){const n=await fetch(e);if(n.url.toLowerCase().indexOf("pagenotfound")>0){let e=location.origin+"/web-twain/docs/about/index.html";e=e.replace("/docs/","/docs-archive"+t),window.location.href=e}else window.location.href=e}function findNearestVersion(e){for(var t=$(".fullVersionInfo li"),n=e,i=null,l=0;l<t.length;l++){var a=$(t[l]).text().toLowerCase();if(a=a.indexOf("latest version")>=0?"latest":a.replace("version ",""),a==e)return a;var r=GetVersionDiff(e,a);(null==i||r>=0&&(r<i||i<0))&&(i=r,n=a)}return i?n:"latest"}function getCurrentUrlProductName(e=null){e=e?e.replace("https://",""):null,e=e?e.replace("http://",""):null;var t=e?e.replace(e.split("/")[0],""):document.location.pathname;t=t.slice(1,t.length);var n=t.split("/")[0];switch(n){case"web-twain":return"dwt";case"barcode-reader":return"dbr";case"label-recognition":return"dlr";case"camera-enhancer":return"dce";case"code-parser":return"dcp";case"document-normalizer":return"ddn";case"capture-vision":return"dcv";case"mobile-web-capture":return"mwc";default:return""}}window.addEventListener("popstate",function(e){findCurLinkOnFullTree({href:location.href},location.href,!0,!0)},!1);