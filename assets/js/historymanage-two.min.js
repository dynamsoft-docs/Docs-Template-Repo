function UrlReplace(){var e=document.URL,n=getUrlVars(e).ver,t=getUrlVars(e).matchVer,i="/v17.2.1/";if(null!=n&&"latest"!=n){var l=findNearestVersion(n);if("latest"!=l&&l!=n){var a=e.replace(n,l);a.indexOf("/docs/")>0&&(a=a.replace("/docs/","/docs-archive"+i),window.location.replace(a))}}null==t&&null!=n&&"latest"!=n&&e.indexOf("/docs/")>0&&(e=e.replace("/docs/","/docs-archive"+i),window.location.replace(e))}function allHerfClick(e,n){return addParam(e),!1}function GetVersionDiff(e,n){if("latest"==n)return 100;if(n<e)return-1;for(var t=e.split("."),i=n.split("."),l=0,a=Math.max(t.length,i.length),o=1,r=0;r<a;r++){var s=r<t.length?t[r]:0;if(isNaN(s)){l+=o;break}var d=r<i.length?i[r]:0;if(isNaN(d)){l+=o;break}var f=d-s;f>=0?(o/=10,l+=o*f):(l-=o,o/=10,l+=o*(f+10))}return l}function addParam(e,n=null,t=!1){if($(e).hasClass("fullUrl"))window.location.href=e.href;else{var i=e.href,l=i;if(""!=i)if("sidebar"==n){var a=document.URL.split("/docs/")[0]+"/docs/";if(e.href.indexOf(a)<0)return void(window.location.href=e.href);$(e).hasClass("activeLink")||RequestNewPage(e,l)}else"docContainer"==n?"_blank"==e.target?window.open(l):findCurLinkOnFullTree(e,l):"_blank"==e.target?window.open(l):window.location.href=l}}function RequestNewPage(e,n,t=!1){$("#articleContent").addClass("hidden"),$("#loadingContent").show(),fetch(e.href).then(function(e){return e.text()}).then(function(i){document.title=$(i)[1].innerText,!t&&history.pushState(null,null,n);for(var l=0;l<$("#fullTreeMenuListContainer .activeLink").parents("li").length;l++){var a=$("#fullTreeMenuListContainer .activeLink").parents("li")[l];$(a).hasClass("hasActiveLinkList")&&$(a).removeClass("hasActiveLinkList")}$("#fullTreeMenuListContainer .activeLink").removeClass("activeLink"),$(e).addClass("activeLink"),$(e).parents("li.collapseListStyle").length>0&&($(e).parents("li.collapseListStyle").addClass("expandListStyle").removeClass("collapseListStyle"),$(e).parents("li.expandListStyle").find(" > ul").slideDown()),$(e).parents("li.expandListStyle").addClass("hasActiveLinkList");var o=$("#articleContent").hasClass("showRightSideMenu");$("#articleContent").html($(i).find("#articleContent").html()).removeClass("hidden"),o||$("#articleContent").find(".rightSideMenu, .markdown-body").removeClass("showRightSideMenu"),$("#loadingContent").hide(),needh3=1==$(i).find("#articleContent").data("needh3");var r=document.getElementsByClassName("mainPage")[0];if(r.scrollHeight>r.clientHeight){var s=$(".activeLink").offset().top-$(".mainPage").offset().top;s-r.scrollTop+40>r.clientHeight&&(r.scrollTop=s-200)}$(".headCounter").hasClass("noTitleIndex")?$("#AutoGenerateSidebar").addClass("noTitleIndex"):$("#AutoGenerateSidebar").removeClass("noTitleIndex");var d=$(i).find("#docHead").find(".iconsBox a")[0].href;$("#docHead .iconsBox a").attr("href",d);var f=$("#articleContent").find("a");for(l=0;l<f.length;l++)f[l].onclick=function(){return addParam(this,"docContainer"),!1};$("#AutoGenerateSidebar").length>0&&GenerateContentByHead(!1),$("#crumbs > ul").html($("#crumbs > ul > li").eq(0)),initCrumbs();var c=$(".markdown-body .highlight pre");for(l=0;l<c.length;l++){var h=document.createElement("i");h.className="copyIcon fa fa-copy",c[l].appendChild(h)}var u=n.split("#").length>1?n.split("#")[1].toLowerCase():null,p=$(window).scrollTop();if(u&&$("#"+u).length>0){var v=$("#"+u).offset().top;setTimeout(function(){console.log(111),$("a[href='#"+u+"']").click()},100)}else if(p>0){v=p>$("#overall-header").height()?$("#overall-header").height():p;setTimeout(function(){window.scrollTo(0,v)},100)}let m=$(".multi-panel-switching-prefix");for(let e=0;e<m.length;e++){let n=$(m[e]).find("+ul > li"),t=0;if(u&&""!=u)for(let e=0;e<n.length;e++)"#"+$(n[e]).find("a").attr("href")==u&&(t=e);$(n[t]).addClass("on");let i=$(m[e]).find("+ul ~");showSelectMultiPanel(i,t)}if($(".multi-panel-switching-prefix + ul > li").on("click",function(){$(this).parent("ul").find("li").removeClass("on"),$(this).addClass("on");let e=$(this).parent("ul").find("~");showSelectMultiPanel(e,$(this).index())}),$(".markdown-body .sample-code-prefix").length>0&&getUrlVars(document.URL).lang){var g=getUrlVars(document.URL).lang.toLowerCase().trim().split(",");g&&(1==g.length?sampleCodeSingleLangInit(g[0]):sampleCodeLangsInit(g))}else if($(".markdown-body .sample-code-prefix").length>0){$(".markdown-body .sample-code-prefix + blockquote > ul > li:first-child").addClass("on"),$(".markdown-body .sample-code-prefix + blockquote > ol > li:first-child").addClass("on");var w=$(".markdown-body .sample-code-prefix.template2 + blockquote");for(l=0;l<w.length;l++)$(w[l]).find(">div").eq(0).addClass("on")}anchors.add()})}function findCurLinkOnFullTree(e,n,t=!1){var i=$("#fullTreeMenuListContainer").find("a"),l=e.href.toLowerCase(),a=document.URL.toLowerCase();if(l=l.indexOf("?")>0?l.split("?")[0]:l.indexOf("#")>0?l.split("#")[0]:l,a=a.indexOf("?")>0?a.split("?")[0]:a.indexOf("#")>0?a.split("#")[0]:a,a==l&&(e.href.split("#").length>1||document.URL.split("#").length>1)){var o=e.href.split("#").length>1?e.href.split("#")[1].toLowerCase():null,r=o&&$("#"+o).length>0?$("#"+o).offset().top:0;setTimeout(function(){window.scrollTo(0,r)},100),!t&&history.pushState(null,null,n)}else{for(var s=!1,d=0;d<i.length;d++){var f=i[d].href;f=f.indexOf("index.html")>0?f.replace("index.html",""):f,l=l.indexOf("index.html")>0?l.replace("index.html",""):l,f=f.indexOf("?")>0?f.split("?")[0]:f.indexOf("#")>0?f.split("#")[0]:f,f&&f.toLowerCase()==l&&(s=!0,RequestNewPage(i[d],n,t))}s||(window.location.href=n)}}function changeVersion(e){var n=e.innerText.toLowerCase(),t=null;t=n.indexOf("latest version")>=0?"latest":n.replace("version ","");var i=document.URL,l="/v"+t+"/";if(i.indexOf("web-twain/docs/")>0&&GetVersionDiff("17.2.1",t)<0&&(l="/v17.2.1/"),(i.indexOf("web-twain/docs/")>0||i.indexOf("remote-scan/docs/")>0)&&"latest"==t)window.location.href=i;else{i=i.replace("/docs/","/docs-archive"+l);var a=getUrlVars(i).src,o=void 0;-1!=i.indexOf("#")&&(o=i.split("#").pop()),-1!=i.indexOf("?")&&(i=i.substring(0,i.indexOf("?"))),-1!=i.indexOf("#")&&(i=i.substring(0,i.indexOf("#"))),i=i+"?ver="+t+"&&cVer=true",null!=a&&(i=i+"&&src="+a),null!=o&&(i=i+"#"+o),window.location.href=i}}function findNearestVersion(e){for(var n=$(".fullVersionInfo li"),t=e,i=null,l=0;l<n.length;l++){var a=$(n[l]).text().toLowerCase();if(a="latest version"==a?"latest":a.replace("version ",""),a==e)return a;var o=GetVersionDiff(e,a);(null==i||o>=0&&(o<i||i<0))&&(i=o,t=a)}return i?t:"latest"}window.addEventListener("popstate",function(e){findCurLinkOnFullTree(location,location.href,!0)},!1);