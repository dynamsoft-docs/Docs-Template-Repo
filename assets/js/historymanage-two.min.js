function UrlReplace(){var docUrl=document.URL,ver=getUrlVars(docUrl).ver,matchVer=getUrlVars(docUrl).matchVer,verFileName="/v17.2.1/";if(null!=ver&&"latest"!=ver){var tempVer=findNearestVersion(ver);if("latest"!=tempVer&&tempVer!=ver){var replaceUrl=docUrl.replace(ver,tempVer);replaceUrl.indexOf("/docs/")>0&&(replaceUrl=replaceUrl.replace("/docs/","/docs-archive/v17.2.1/"),window.location.replace(replaceUrl))}}null==matchVer&&null!=ver&&"latest"!=ver&&docUrl.indexOf("/docs/")>0&&(docUrl=docUrl.replace("/docs/","/docs-archive/v17.2.1/"),window.location.replace(docUrl))}function allHerfClick(_this,ver){return addParam(_this),!1}function GetVersionDiff(inputVer,compareVer){if("latest"==compareVer)return 100;if(compareVer<inputVer)return-1;for(var inputChar=inputVer.split("."),compareChar=compareVer.split("."),diff=0,maxLength=Math.max(inputChar.length,compareChar.length),curWeight=1,i=0;i<maxLength;i++){var tmpInput=i<inputChar.length?inputChar[i]:0;if(isNaN(tmpInput)){diff+=curWeight;break}var tmpCompare=i<compareChar.length?compareChar[i]:0;if(isNaN(tmpCompare)){diff+=curWeight;break}var tmpDiff=tmpCompare-tmpInput;tmpDiff>=0?diff+=(curWeight/=10)*tmpDiff:(diff-=curWeight,diff+=(curWeight/=10)*(tmpDiff+10))}return diff}function addParam(aTag,fromSourse=null,needh3=!1){if($(aTag).hasClass("fullUrl"))window.location.href=aTag.href;else{var hrefVal=aTag.href,changeHref=hrefVal;if(""!=hrefVal)if("sidebar"==fromSourse){var currentDocDomain=document.URL.split("/docs/")[0]+"/docs/";if(aTag.href.indexOf(currentDocDomain)<0)return void(window.location.href=aTag.href);$(aTag).hasClass("activeLink")||RequestNewPage(aTag,changeHref)}else"docContainer"==fromSourse?"_blank"==aTag.target?window.open(changeHref):findCurLinkOnFullTree(aTag,changeHref):"_blank"==aTag.target?window.open(changeHref):window.location.href=changeHref}}function RequestNewPage(aTag,paramLink,onlyLoadContent=!1){$("#articleContent").addClass("hidden"),$("#loadingContent").show(),fetch(aTag.href).then((function(response){return response.text()})).then((function(data){document.title=$(data)[1].innerText,!onlyLoadContent&&history.pushState(null,null,paramLink);for(var i=0;i<$("#fullTreeMenuListContainer .activeLink").parents("li").length;i++){var obj=$("#fullTreeMenuListContainer .activeLink").parents("li")[i];$(obj).hasClass("hasActiveLinkList")&&$(obj).removeClass("hasActiveLinkList")}$("#fullTreeMenuListContainer .activeLink").removeClass("activeLink"),$(aTag).addClass("activeLink"),$(aTag).parents("li.collapseListStyle").length>0&&($(aTag).parents("li.collapseListStyle").addClass("expandListStyle").removeClass("collapseListStyle"),$(aTag).parents("li.expandListStyle").find(" > ul").slideDown()),$(aTag).parents("li.expandListStyle").addClass("hasActiveLinkList");var showRightSideMenu=$("#articleContent").hasClass("showRightSideMenu");$("#articleContent").html($(data).find("#articleContent").html()).removeClass("hidden"),showRightSideMenu||$("#articleContent").find(".rightSideMenu, .markdown-body").removeClass("showRightSideMenu"),$("#loadingContent").hide(),needh3=1==$(data).find("#articleContent").data("needh3");var scrollDiv=document.getElementsByClassName("mainPage")[0];if(scrollDiv.scrollHeight>scrollDiv.clientHeight){var activeLinkOffsetTop=$(".activeLink").offset().top-$(".mainPage").offset().top;activeLinkOffsetTop-scrollDiv.scrollTop+40>scrollDiv.clientHeight&&(scrollDiv.scrollTop=activeLinkOffsetTop-200)}$(".headCounter").hasClass("noTitleIndex")?$("#AutoGenerateSidebar").addClass("noTitleIndex"):$("#AutoGenerateSidebar").removeClass("noTitleIndex");var editMdFileLink=$(data).find("#docHead").find(".iconsBox a")[0].href;$("#docHead .iconsBox a").attr("href",editMdFileLink);for(var articleContentATags=$("#articleContent").find("a"),i=0;i<articleContentATags.length;i++)articleContentATags[i].onclick=function(){return addParam(this,"docContainer"),!1};$("#AutoGenerateSidebar").length>0&&GenerateContentByHead(!1),$("#crumbs > ul").html($("#crumbs > ul > li").eq(0)),initCrumbs();for(var preList=$(".markdown-body .highlight pre"),i=0;i<preList.length;i++){var iconItem=document.createElement("i");iconItem.className="copyIcon fa fa-copy",preList[i].appendChild(iconItem)}var hash=paramLink.split("#").length>1?paramLink.split("#")[1].toLowerCase():null,sd=$(window).scrollTop();hash&&$("#"+hash).length>0?window.scrollTo(0,$("#"+hash).offset().top):sd>0&&window.scrollTo(0,sd>$("#overall-header").height()?$("#overall-header").height():sd);let multiPanelListSwitchingItems=$(".multi-panel-switching-prefix");for(let i=0;i<multiPanelListSwitchingItems.length;i++){let multiPanelSwitchBtns=$(multiPanelListSwitchingItems[i]).find("+ul > li"),switchIndex=0;if(hash&&""!=hash)for(let j=0;j<multiPanelSwitchBtns.length;j++)"#"+$(multiPanelSwitchBtns[j]).find("a").attr("href")==hash&&(switchIndex=j);$(multiPanelSwitchBtns[switchIndex]).addClass("on");let nextSiblings=$(multiPanelListSwitchingItems[i]).find("+ul ~");showSelectMultiPanel(nextSiblings,switchIndex)}if($(".multi-panel-switching-prefix + ul > li").on("click",(function(){$(this).parent("ul").find("li").removeClass("on"),$(this).addClass("on");let nextSiblings=$(this).parent("ul").find("~");showSelectMultiPanel(nextSiblings,$(this).index())})),$(".markdown-body .sample-code-prefix").length>0&&getUrlVars(document.URL).lang){var langs=getUrlVars(document.URL).lang.toLowerCase().trim().split(",");langs&&(1==langs.length?sampleCodeSingleLangInit(langs[0]):sampleCodeLangsInit(langs))}else if($(".markdown-body .sample-code-prefix").length>0){$(".markdown-body .sample-code-prefix + blockquote > ul > li:first-child").addClass("on"),$(".markdown-body .sample-code-prefix + blockquote > ol > li:first-child").addClass("on");for(var template2Objs=$(".markdown-body .sample-code-prefix.template2 + blockquote"),i=0;i<template2Objs.length;i++)$(template2Objs[i]).find(">div").eq(0).addClass("on")}anchors.add()}))}function findCurLinkOnFullTree(aTag,paramLink,onlyLoadContent=!1){var fullTreeATags=$("#fullTreeMenuListContainer").find("a"),targetHref=aTag.href.toLowerCase(),curDocUrl=document.URL.toLowerCase();if(targetHref=targetHref.indexOf("?")>0?targetHref.split("?")[0]:targetHref.indexOf("#")>0?targetHref.split("#")[0]:targetHref,(curDocUrl=curDocUrl.indexOf("?")>0?curDocUrl.split("?")[0]:curDocUrl.indexOf("#")>0?curDocUrl.split("#")[0]:curDocUrl)==targetHref&&(aTag.href.split("#").length>1||document.URL.split("#").length>1)){var hash=aTag.href.split("#").length>1?aTag.href.split("#")[1].toLowerCase():null;window.scrollTo(0,hash&&$("#"+hash).length>0?$("#"+hash).offset().top:0),!onlyLoadContent&&history.pushState(null,null,paramLink)}else{for(var flag=!1,i=0;i<fullTreeATags.length;i++){var searchHref=fullTreeATags[i].href;searchHref=searchHref.indexOf("index.html")>0?searchHref.replace("index.html",""):searchHref,targetHref=targetHref.indexOf("index.html")>0?targetHref.replace("index.html",""):targetHref,(searchHref=searchHref.indexOf("?")>0?searchHref.split("?")[0]:searchHref.indexOf("#")>0?searchHref.split("#")[0]:searchHref)&&searchHref.toLowerCase()==targetHref&&(flag=!0,RequestNewPage(fullTreeATags[i],paramLink,onlyLoadContent))}flag||(window.location.href=paramLink)}}function changeVersion(liTag){var innertext=liTag.innerText.toLowerCase(),ver=null;ver=innertext.indexOf("latest version")>=0?"latest":innertext.replace("version ","");var curUrl=document.URL,verFileName="/v"+ver+"/";if(curUrl.indexOf("web-twain/docs/")>0&&GetVersionDiff("17.2.1",ver)<0&&(verFileName="/v17.2.1/"),(curUrl.indexOf("web-twain/docs/")>0||curUrl.indexOf("remote-scan/docs/")>0)&&"latest"==ver)window.location.href=curUrl;else{curUrl=curUrl.replace("/docs/","/docs-archive"+verFileName);var srcVal=getUrlVars(curUrl).src,anchorVar=void 0;-1!=curUrl.indexOf("#")&&(anchorVar=curUrl.split("#").pop()),-1!=curUrl.indexOf("?")&&(curUrl=curUrl.substring(0,curUrl.indexOf("?"))),-1!=curUrl.indexOf("#")&&(curUrl=curUrl.substring(0,curUrl.indexOf("#"))),curUrl=curUrl+"?ver="+ver+"&&cVer=true",null!=srcVal&&(curUrl=curUrl+"&&src="+srcVal),null!=anchorVar&&(curUrl=curUrl+"#"+anchorVar),window.location.href=curUrl}}function findNearestVersion(ver){for(var versionList=$(".fullVersionInfo li"),bestVer=ver,verDiff=null,i=0;i<versionList.length;i++){var tempVer=$(versionList[i]).text().toLowerCase();if((tempVer="latest version"==tempVer?"latest":tempVer.replace("version ",""))==ver)return tempVer;var tmpDiff=GetVersionDiff(ver,tempVer);(null==verDiff||tmpDiff>=0&&(tmpDiff<verDiff||verDiff<0))&&(verDiff=tmpDiff,bestVer=tempVer)}return verDiff?bestVer:"latest"}window.addEventListener("popstate",(function(e){findCurLinkOnFullTree(location,location.href,!0)}),!1);