function FullTreeMenuList(e,t=!0){for(var n=$(".docContainer .content, #docHead, #AutoGenerateSidebar, .sideBar, #crumbs").find("a"),a=0;a<n.length;a++){getUrlVars(document.URL);n[a].onclick=function(){return!$(this).hasClass("refreshLink")&&$(this).parents(".sideBar").length>0&&$("#articleContent").length>0?addParam(this,"sidebar",t):!$(this).hasClass("refreshLink")&&$(this).parents(".markdown-body").length>0&&$("#articleContent").length>0?addParam(this,"docContainer",t):addParam(this),!1}}var i=document.getElementById("fullTreeMenuListContainer");if(null!=i){AddCanonicalLinkOnPage(document.URL),ExpandCurrentPageTree("fullTreeMenuListContainer"),initCrumbs(),e=1==e||"true"==e,e&&(t="true"==t||1==t,t&&$("#fullTreeMenuListContainer").addClass("needh3"),GenerateContentByHead(t));let n=$(".multi-panel-switching-prefix");for(let e=0;e<n.length;e++){let a=$(n[e]).find("+ul > li"),i=location.hash,l=0;if(i&&""!=i)for(let e=0;e<a.length;e++)$(a[e]).find("a").attr("href")==i&&(l=e);$(a[l]).addClass("on");let s=$(n[e]).find("+ul ~");showSelectMultiPanel(s,l,t)}$(".multi-panel-switching-prefix + ul > li").on("click",function(){$(this).parent("ul").find("li").removeClass("on"),$(this).addClass("on");let e=$(this).parent("ul").find("~");showSelectMultiPanel(e,$(this).index(),t)})}}function AddCanonicalLinkOnPage(e=document.URL){var t=e;e=e.replace(/\/index-v[0-9]+[^\/]*.html/g,"/"),e=e.replace(/-v[0-9]+[^\/]*\//g,"/"),e=e.replace(/-v[0-9]+[^\/]*.html/g,".html");var n=document.head||document.getElementsByTagName("head")[0];if(e!=t){t=e,-1!=t.indexOf("#")&&(t=t.substring(0,t.indexOf("#"))),-1!=t.indexOf("?")&&(t=t.substring(0,t.indexOf("?")));var a=document.createElement("link");a.href=t,a.rel="canonical",n.appendChild(a)}}function GenerateContentByHead(e=!0){var t,n=[],a="<ul>";t=e?document.querySelectorAll(".content h2, .content h3"):document.querySelectorAll(".content h2");for(let e=0;e<t.length;e++)$(t[e]).is(":visible")&&n.push(t[e]);for(var i=0;i<n.length;i++){var l=$(n[i]).text(),s=$(n[i]).attr("id"),r='<li style="list-style-image: none; list-style-type: circle;"><a href="#'+s+'" class="otherLinkColour">'+l+"</a>";if(i+1<n.length&&"h2"==n[i].localName&&"h3"==n[i+1].localName){r+='<ul name="listLevel2">';for(var d=i+1;d<n.length&&"h3"==n[d].localName;d++){i=d;var o=$(n[d]).text(),c=$(n[d]).attr("id");r+='<li style="list-style-image: none; list-style-type: disc;"><a href="#'+c+'" class="otherLinkColour">'+o+"</a></li>"}r+="</ul>"}else r+="</li>";a+=r}a+="</ul>",0!=$("#AutoGenerateSidebar").length&&($("#AutoGenerateSidebar").html(""),$("#AutoGenerateSidebar").append(a),0==$("#AutoGenerateSidebar > ul > li").length?$(".rightSideMenu > p").hide():$(".rightSideMenu > p").show())}function ExpandCurrentPageTree(e){if($("#"+e).find(".activeLink").parent().parents("li").removeClass("collapseListStyle").addClass("expandListStyle"),$("#"+e).find(".activeLink").parent().length>0&&$("#"+e).find(".activeLink").parent()[0].dataset.ishashnode){var t=$("#"+e).find(".activeLink"),n=$(t).parent().find("a");if(document.URL.indexOf("#")>0)for(var a=location.hash,i=document.URL.split("?")[0]+a,l=0;l<n.length;l++)n[l].href==i&&($(n[l]).addClass("activeLink"),$(t).addClass("childHashItemsLink"));$(n).on("click",function(){$(n).removeClass("activeLink"),$(this).addClass("activeLink")})}document.URL.indexOf("/docs/faq/")>0&&document.URL.indexOf(".html")>0&&$("#"+e).find(">li:last-child").removeClass("collapseListStyle").addClass("expandListStyle")}function getUrlVars(e){var t={};e.replace(/[?&]+([^=&]+)=([^&^#]*)/gi,function(e,n,a){t[n]=a});return t}function UsefulRecord(e){var t=encodeURIComponent(document.URL);e?$.get("https://www.dynamsoft.com/Secure/Rate.ashx?paper="+t+"&product=DBR-Doc&rate=5"):$.get("https://www.dynamsoft.com/Secure/Rate.ashx?paper="+t+"&product=DBR-Doc&rate=1");var n=document.getElementById("feedbackFooter");null!=n&&(n.innerHTML="Thanks!")}function initCrumbs(){var e=$("#crumbs").children("ul");if(0!=e.length){for(var t="",n=$("#fullTreeMenuListContainer .expandListStyle"),a=0;a<n.length;a++)if($(n[a]).find(".activeLink").length>0){var i=$(n[a]).find("> a");$(i).hasClass("activeLink")?t+='<li id="breadcrumbLastNode">'+$(i)[0].textContent+"</li>":t+='<li><a class="bluelink" href = "'+$(i)[0].href+'">'+$(i)[0].textContent+"</a></li>"}var l=$("#fullTreeMenuListContainer a.activeLink");l.length>0&&!$(l[0]).parent().hasClass("expandListStyle")&&(t+='<li id="breadcrumbLastNode">'+$(l[0]).text()+"</li>"),document.URL.indexOf("/docs/faq/")>0&&document.URL.indexOf(".html")>0&&(t+='<li><a class="bluelink" href = "https://www.dynamsoft.com/web-twain/docs/faq/">FAQ</a></li>'),$(e[0]).append(t)}}function showSelectMultiPanel(e,t,n){let a=!1,i=0,l=[],s=!1,r="h2";for(let n=0;n<e.length&&!$(e[n]).hasClass("multi-panel-switching-end");n++)if($(e[n]).hasClass("multi-panel-start")&&(i==t&&(a=!0),i++),a&&$(e[n]).hasClass("multi-panel-end")&&(a=!1),a){if($(e[n]).is("table")){let t=$(e[n]).find("a");for(let e=0;e<t.length;e++){let n="#"+$(t[e]).attr("href").split("#")[1];l.push(n)}}$(e[n]).show()}else{let t=e[n].id;l.includes("#"+t)?(r=e[n].tagName,s=!0,$(e[n]).show()):s&&!$(e[n]).is(r)?$(e[n]).show():(s=!1,$(e[n]).hide())}GenerateContentByHead(n)}